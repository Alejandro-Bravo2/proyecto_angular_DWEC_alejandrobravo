<section class="progress-page">
  <header class="progress-page__header">
    <h1>Tu Progreso</h1>
  </header>

  @if (error()) {
    <aside class="error-message" role="alert">{{ error() }}</aside>
  }

  <!-- Barra de busqueda para progreso -->
  <search class="progress-page__search">
    <fieldset class="search-input-wrapper">
      <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.3-4.3"/>
      </svg>
      <input
        type="search"
        [formControl]="searchControl"
        placeholder="Buscar ejercicios..."
        class="search-input"
        aria-label="Buscar en progreso"
      />
      @if (store.searchTerm()) {
        <button
          type="button"
          class="search-clear"
          (click)="clearSearch()"
          aria-label="Limpiar busqueda"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M18 6 6 18"/>
            <path d="m6 6 12 12"/>
          </svg>
        </button>
      }
    </fieldset>
    @if (store.searchTerm()) {
      <output class="search-results-count" aria-live="polite">
        {{ store.filteredEntries().length }} entrada(s) encontrada(s)
      </output>
    }
  </search>

  <section class="progress-page__content">
    <app-nutrient-counter [nutrientData]="nutrientData()" />
    <app-strength-gain-chart
      [progressEntries]="store.paginatedEntries()"
      [exercises]="exercises()"
    />
  </section>

  <!-- Controles de paginacion -->
  @if (store.totalPages() > 1) {
    <nav class="pagination" aria-label="Paginacion de progreso">
      <button
        type="button"
        class="pagination__btn"
        (click)="previousPage()"
        [disabled]="store.currentPage() === 1"
        aria-label="Pagina anterior"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m15 18-6-6 6-6"/>
        </svg>
        Anterior
      </button>

      <span class="pagination__info">
        Pagina {{ store.currentPage() }} de {{ store.totalPages() }}
      </span>

      <button
        type="button"
        class="pagination__btn"
        (click)="nextPage()"
        [disabled]="store.currentPage() >= store.totalPages()"
        aria-label="Pagina siguiente"
      >
        Siguiente
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m9 18 6-6-6-6"/>
        </svg>
      </button>
    </nav>
  }
</section>