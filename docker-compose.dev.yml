# ============================================================================
# COFIRA - Docker Compose Configuration (DEVELOPMENT OVERRIDES)
# ============================================================================
# Este archivo extiende docker-compose.yml con configuraciones de desarrollo.
# Uso: docker compose -f docker-compose.yml -f docker-compose.dev.yml --env-file .env.dev up --build
# ============================================================================

services:
  # ==========================================================================
  # DATABASE: PostgreSQL (exponer puerto para herramientas locales)
  # ==========================================================================
  postgres:
    container_name: cofira-dev-postgres
    restart: unless-stopped
    ports:
      - "${DB_PORT:-5432}:5432"

  # ==========================================================================
  # DATABASE ADMIN: PgAdmin (solo en desarrollo)
  # ==========================================================================
  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: cofira-dev-pgadmin
    restart: unless-stopped
    environment:
      PGADMIN_DEFAULT_EMAIL: ${PGADMIN_EMAIL:-admin@admin.com}
      PGADMIN_DEFAULT_PASSWORD: ${PGADMIN_PASSWORD:-admin123}
      PGADMIN_CONFIG_SERVER_MODE: "False"
    ports:
      - "5050:80"
    volumes:
      - pgadmin_data:/var/lib/pgadmin
    networks:
      - cofira-network
    depends_on:
      postgres:
        condition: service_healthy

  # ==========================================================================
  # BACKEND: Spring Boot API (exponer puerto para debugging)
  # ==========================================================================
  backend:
    container_name: cofira-dev-backend
    restart: unless-stopped
    ports:
      - "8081:8080"

  # ==========================================================================
  # FRONTEND: Angular Application (puerto configurable)
  # ==========================================================================
  frontend:
    container_name: cofira-dev-frontend
    restart: unless-stopped
    ports:
      - "${ANGULAR_PORT:-4200}:80"

# ============================================================================
# VOLUMES (adicional para desarrollo)
# ============================================================================
volumes:
  pgadmin_data:
    driver: local
